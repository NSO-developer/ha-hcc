FROM debian:11-slim

ARG NODE3_NAME

RUN apt-get update \
    && apt-get install -y --no-install-recommends socat \
    openssh-client python3 python3-pip python3-setuptools iputils-ping nano \
    && python3 -m pip install --upgrade pip \
    && python3 -m pip install --no-cache-dir paramiko requests packaging

ADD ${NODE3_NAME}.tar.gz /
WORKDIR /root
RUN tar xvfz /${NODE3_NAME}/ssh-keys.tar.gz \
    && rm /${NODE3_NAME}/ssh-keys.tar.gz

WORKDIR /${NODE3_NAME}
EXPOSE 12024
CMD [ "./run.sh" ]
